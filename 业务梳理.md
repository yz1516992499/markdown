

#### **合同**

- **获取合同详情**：`getContractFabricDetail`。
  - 获取Fabric合同详情（合同 ID、当前用户、用户类型、合同签名参与者列表）。
  - 使用`webClientService`发起请求。
  - 将响应数据转换为 `ContractFabricAppDetailJsonView` 返回。
- **复制签署合同**：`contractCopySignedToPreviewWithNewName`。
  - 接受合同 ID。
  - 获取合同对象。
  - 将已签署的合同文件复制为新的预览文件。
  - 调用 `contractService` 保存合同对象（`contract`）。
- **预览签名**：`previewSignByAdvisor`、`previewSignByFinder`、`previewSignByUplineFinder`。
  - 接收合同ID和签名照片。
  - 获取指定`id`和状态为`PREPARE`的合同信息。
  - 创建并初始化合同预览签名页面对象`ContractPreviewSignPageAppJsonView`。
  - 设置合同预览页面的各项属性，包括合同的基本信息和关联的加入请求信息。
  - 调用服务层的方法生成合同预览签名文件，并检查文件是否存在。
  - 如果文件存在，将其转换为PDF格式并发布转换事件，否则抛出文件未找到的异常。
- **签名**：`signByAdvisor`。
  - 接收合同ID。
  - 获取当前登录用户信息。
  - 调用服务层方法，由Advisor签署合同（`signContractByAdvisor`）。
  - 创建签署合同记录（`sign_contract_record`)，发布相关事件（`PostRequestFabricCreateEvent`）。
  - 发布用户快照事件（`ApplicationUserSnapshotEvent`）。
  - 发布合同签署通知事件（`ContractSignedByAdvisorNotificationEvent`）。
  - 结束合同签署流程，保存合同（`contract`）。

